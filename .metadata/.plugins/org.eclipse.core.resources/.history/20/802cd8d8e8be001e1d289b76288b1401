package pizzeria_v04;

import java.sql.Connection;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.util.ArrayList;

public class PonerDatos {

	public static void ponerPizzas(ArrayList<Pizza> pizzaList, Connection conexion) throws SQLException {
		Statement sentencia = conexion.createStatement();
		String consulta = "DELETE from pizzeria.pizza;";
		sentencia.executeUpdate(consulta);
		for (int cont = 0; cont < pizzaList.size(); cont++) {
			consulta = "INSERT INTO pizzeria.pizza VALUES ( " + pizzaList.get(cont).getId() + ",'" + pizzaList.get(cont).getNombre() + "','" + pizzaList.get(cont).getIngredientes() + "'," + pizzaList.get(cont).getPrecio() + ");";
			sentencia.executeUpdate(consulta);
		}
	}
	public static void obtenerUsuarios(ArrayList<Usuario> usuarioList, Connection conexion) throws SQLException {
		Statement sentencia = conexion.createStatement();
		ResultSet resultado = sentencia.executeQuery("SELECT * FROM usuario");
		while (resultado.next()) {
			usuarioList.add(new Usuario(resultado.getInt("id"), resultado.getString("nombre"), resultado.getString("apellido")));
		}
	}
	public static void obtenerPedidos(ArrayList<Pedido> pedidoList, Connection conexion) throws SQLException {
		Statement sentencia = conexion.createStatement();
		ResultSet resultado = sentencia.executeQuery("SELECT * FROM pedido");
		while (resultado.next()) {
			pedidoList.add(new Pedido(resultado.getInt("idpizza"), resultado.getInt("idusuario"), resultado.getInt("idpedido"), resultado.getInt("cantidad")));
		}
	}	
	
}
